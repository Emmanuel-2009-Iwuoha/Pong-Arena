<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pong League 2.0 - Tournament Admin Center</title>
    <link rel="stylesheet" href="style-v2.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<style>
        /* Enhanced Tournament Bracket Styles with Advanced Visual Design */
        .tournament-bracket-section {
            margin: var(--spacing-xl) 0;
            background: linear-gradient(135deg, rgba(10, 10, 10, 0.95), rgba(20, 20, 30, 0.95));
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }
        
        .bracket-container {
            display: flex;
            gap: var(--spacing-xl);
            overflow-x: auto;
            overflow-y: visible;
            padding: var(--spacing-xl);
            min-height: 600px;
            background: radial-gradient(ellipse at center, rgba(0, 255, 136, 0.08), rgba(0, 153, 255, 0.05), transparent);
            border-radius: var(--radius-lg);
            position: relative;
        }
        
        .bracket-container::-webkit-scrollbar {
            height: 12px;
        }
        
        .bracket-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }
        
        .bracket-container::-webkit-scrollbar-thumb {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 6px;
        }
        
        .bracket-round {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            min-width: 240px;
            position: relative;
            animation: fadeInUp 0.6s ease-out backwards;
        }
        
        .bracket-round:nth-child(1) { animation-delay: 0.1s; }
        .bracket-round:nth-child(2) { animation-delay: 0.2s; }
        .bracket-round:nth-child(3) { animation-delay: 0.3s; }
        .bracket-round:nth-child(4) { animation-delay: 0.4s; }
        .bracket-round:nth-child(5) { animation-delay: 0.5s; }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .round-header {
            font-family: var(--font-primary);
            color: var(--primary-color);
            text-align: center;
            margin-bottom: var(--spacing-lg);
            padding: var(--spacing-md);
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.15), rgba(0, 153, 255, 0.15));
            border: 2px solid var(--primary-color);
            border-radius: var(--radius-lg);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .round-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .bracket-match {
            background: linear-gradient(135deg, rgba(20, 20, 30, 0.9), rgba(10, 10, 20, 0.9));
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
            margin: var(--spacing-md) 0;
            transition: all var(--transition-normal);
            position: relative;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }
        
        .bracket-match::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .bracket-match:hover::before {
            opacity: 1;
        }
        
        .bracket-match.pending {
            border-color: var(--warning-color);
            background: linear-gradient(135deg, rgba(255, 170, 0, 0.12), rgba(255, 140, 0, 0.08));
            box-shadow: 0 4px 20px rgba(255, 170, 0, 0.25);
        }
        
        .bracket-match.active {
            border-color: var(--success-color);
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.15), rgba(0, 200, 100, 0.1));
            animation: matchPulse 2s ease-in-out infinite;
            box-shadow: 0 6px 30px rgba(0, 255, 136, 0.4);
        }
        
        .bracket-match.completed {
            border-color: rgba(0, 153, 255, 0.6);
            background: linear-gradient(135deg, rgba(0, 153, 255, 0.1), rgba(0, 100, 200, 0.08));
            box-shadow: 0 4px 15px rgba(0, 153, 255, 0.2);
        }
        
        .bracket-match.bye {
            border-color: rgba(136, 136, 136, 0.4);
            background: linear-gradient(135deg, rgba(136, 136, 136, 0.08), rgba(100, 100, 100, 0.06));
            opacity: 0.75;
        }
        
        @keyframes matchPulse {
            0%, 100% { 
                box-shadow: 0 6px 30px rgba(0, 255, 136, 0.4);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 8px 40px rgba(0, 255, 136, 0.6);
                transform: scale(1.02);
            }
        }
        
        .match-player {
            padding: var(--spacing-sm) var(--spacing-md);
            margin: 3px 0;
            border-radius: var(--radius-md);
            font-family: var(--font-secondary);
            font-size: 0.95rem;
            transition: all var(--transition-fast);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid transparent;
        }
        /* Add this to the <style> section in admin.html, after the existing .match-player styles */

.match-player.eliminated {
    background: linear-gradient(90deg, rgba(255, 68, 68, 0.25), rgba(200, 50, 50, 0.15));
    border: 1px solid var(--error-color);
    color: rgba(255, 100, 100, 0.9);
    animation: eliminatedGlow 2s ease-in-out infinite;
    position: relative;
}

.match-player.eliminated::after {
    content: '‚úï';
    position: absolute;
    right: var(--spacing-sm);
    color: var(--error-color);
    font-weight: bold;
    font-size: 1.1rem;
    animation: eliminatedPulse 1.5s ease-in-out infinite;
}

@keyframes eliminatedGlow {
    0%, 100% {
        box-shadow: 0 2px 10px rgba(255, 68, 68, 0.3);
        border-color: rgba(255, 68, 68, 0.5);
    }
    50% {
        box-shadow: 0 4px 20px rgba(255, 68, 68, 0.6);
        border-color: rgba(255, 68, 68, 0.8);
    }
}

@keyframes eliminatedPulse {
    0%, 100% {
        opacity: 0.6;
        transform: scale(1);
    }
    50% {
        opacity: 1;
        transform: scale(1.2);
    }
}
        
        .match-player::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 0;
            background: currentColor;
            transition: height var(--transition-fast);
        }
        
        .match-player:hover::before {
            height: 70%;
        }
        
        .match-player.winner {
            background: linear-gradient(90deg, rgba(0, 255, 136, 0.25), rgba(0, 200, 100, 0.15));
            border: 1px solid var(--success-color);
            color: var(--success-color);
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0, 255, 136, 0.3);
            animation: winnerGlow 2s ease-in-out infinite;
        }
        
        @keyframes winnerGlow {
            0%, 100% {
                box-shadow: 0 2px 10px rgba(0, 255, 136, 0.3);
            }
            50% {
                box-shadow: 0 4px 20px rgba(0, 255, 136, 0.5);
            }
        }
        
        .match-player.loser {
            background: linear-gradient(90deg, rgba(255, 68, 68, 0.2), rgba(200, 50, 50, 0.12));
            border: 1px solid rgba(255, 68, 68, 0.5);
            color: rgba(255, 100, 100, 0.9);
            opacity: 0.7;
            text-decoration: line-through;
            position: relative;
        }
        
        .match-player.loser::after {
            content: '‚úï';
            position: absolute;
            right: var(--spacing-sm);
            color: var(--error-color);
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .match-vs {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.75rem;
            font-family: var(--font-primary);
            margin: var(--spacing-xs) 0;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .bye-indicator {
            text-align: center;
            color: var(--text-muted);
            font-style: italic;
            font-size: 0.85rem;
            padding: var(--spacing-sm);
            background: rgba(136, 136, 136, 0.1);
            border-radius: var(--radius-sm);
            border: 1px dashed rgba(136, 136, 136, 0.3);
        }
        
        .match-score {
            text-align: center;
            font-family: var(--font-primary);
            color: var(--primary-color);
            font-size: 0.9rem;
            margin-top: var(--spacing-sm);
            padding: var(--spacing-xs) var(--spacing-sm);
            background: rgba(0, 255, 136, 0.1);
            border-radius: var(--radius-sm);
            border: 1px solid rgba(0, 255, 136, 0.3);
        }
        
        .bracket-connection {
            position: absolute;
            right: -30px;
            top: 50%;
            width: 30px;
            height: 2px;
            background: linear-gradient(90deg, var(--border-color), transparent);
            z-index: 0;
        }
        
        .bracket-connection::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid var(--border-color);
            border-top: 4px solid transparent;
            border-bottom: 4px solid transparent;
        }
        
        .champion-display {
            text-align: center;
            padding: var(--spacing-xxl);
            background: linear-gradient(135deg, #ffd700, #ff8c00, #ffa500);
            background-size: 200% 200%;
            animation: championGradient 3s ease infinite;
            border-radius: var(--radius-xl);
            margin: var(--spacing-xl) 0;
            color: white;
            font-family: var(--font-primary);
            box-shadow: 0 10px 50px rgba(255, 215, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        @keyframes championGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .champion-display::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3), transparent);
            animation: championShine 4s linear infinite;
        }
        
        @keyframes championShine {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .champion-display h2 {
            font-size: 2.5rem;
            margin-bottom: var(--spacing-lg);
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7);
            position: relative;
            z-index: 1;
        }
        
        .champion-display .champion-name {
            position: relative;
            z-index: 1;
        }
        
        .tournament-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: var(--spacing-md);
            margin: var(--spacing-lg) 0;
        }
        
        .tournament-stat-card {
            background: linear-gradient(135deg, var(--bg-glass), rgba(0, 255, 136, 0.05));
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            text-align: center;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .tournament-stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }
        
        .tournament-stat-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 6px 25px rgba(0, 255, 136, 0.3);
            transform: translateY(-3px);
        }
        
        .tournament-stat-value {
            font-family: var(--font-primary);
            font-size: 2rem;
            color: var(--primary-color);
            display: block;
            margin-bottom: var(--spacing-sm);
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }
        
        .tournament-stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .elimination-list {
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.08), rgba(200, 50, 50, 0.05));
            border: 2px solid rgba(255, 68, 68, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            max-height: 350px;
            overflow-y: auto;
            margin-top: var(--spacing-lg);
        }
        
        .elimination-list h3 {
            color: var(--error-color);
            margin-bottom: var(--spacing-md);
            text-align: center;
            font-size: 1rem;
        }
        
        .elimination-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-md);
            border-bottom: 1px solid rgba(255, 68, 68, 0.2);
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-sm);
            margin-bottom: var(--spacing-xs);
            transition: all var(--transition-fast);
        }
        
        .elimination-item:hover {
            background: rgba(255, 68, 68, 0.15);
            border-bottom-color: rgba(255, 68, 68, 0.4);
        }
        
        .elimination-item::before {
            content: '‚úï';
            color: var(--error-color);
            margin-right: var(--spacing-sm);
            font-weight: bold;
        }
        
        .elimination-round {
            font-size: 0.8rem;
            color: rgba(255, 100, 100, 0.8);
            background: rgba(255, 68, 68, 0.15);
            padding: 2px 8px;
            border-radius: var(--radius-sm);
        }
        
        .golden-goal-indicator {
            position: absolute;
            top: 8px;
            right: 8px;
            background: linear-gradient(45deg, var(--warning-color), #ff8c00);
            color: white;
            padding: 4px 8px;
            border-radius: var(--radius-sm);
            font-size: 0.65rem;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 2px 10px rgba(255, 170, 0, 0.5);
            animation: goldenPulse 1.5s ease-in-out infinite;
            z-index: 10;
        }

        .commentary-status {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-md);
    padding: var(--spacing-md);
    background: rgba(0, 0, 0, 0.3);
    border-radius: var(--radius-md);
}

.commentary-controls {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-md);
}

.audio-visualizer {
    background: rgba(0, 0, 0, 0.5);
    border-radius: var(--radius-md);
    padding: var(--spacing-sm);
    margin-bottom: var(--spacing-md);
}

#visualizerCanvas {
    width: 100%;
    height: 100px;
    display: block;
}

.commentary-info {
    text-align: center;
    color: var(--text-muted);
}
        
        @keyframes goldenPulse {
            0%, 100% {
                box-shadow: 0 2px 10px rgba(255, 170, 0, 0.5);
            }
            50% {
                box-shadow: 0 4px 20px rgba(255, 170, 0, 0.8);
            }
        }
        
        .match-metadata {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: var(--spacing-xs);
            padding-top: var(--spacing-xs);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .match-timestamp {
            font-size: 0.7rem;
            color: var(--text-muted);
            font-family: monospace;
        }
        
        .match-status-badge {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: var(--radius-sm);
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .match-status-badge.live {
            background: var(--success-color);
            color: white;
            animation: liveBadge 1s ease-in-out infinite;
        }
        
        @keyframes liveBadge {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body>
    <!-- Connection Status -->
    <div id="connectionStatus" class="connection-status">
        <div class="status-indicator" id="statusIndicator"></div>
        <span id="statusText">Connecting...</span>
        <div class="latency-display" id="latencyDisplay">0ms</div>
    </div>

    <div class="container">
        <!-- Enhanced Header -->
        <div class="header">
            <div class="header-glow"></div>
            <h1 class="main-title">
                <span class="glitch" data-text="üèÜ TOURNAMENT ADMIN CENTER">üèÜ TOURNAMENT ADMIN CENTER</span>
            </h1>
            <p class="subtitle">Advanced Championship Control & Bracket Management</p>
            <div class="feature-tags">
                <span class="tag">Tournament Brackets</span>
                <span class="tag">Golden Goal System</span>
                <span class="tag">Fair Bye Allocation</span>
                <span class="tag">Real-time Monitoring</span>
            </div>
        </div>

        <!-- Server Health Dashboard -->
        <div class="dashboard-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-icon">üñ•Ô∏è</div>
                    <div class="metric-title">Server Status</div>
                </div>
                <div class="metric-value" id="serverUptime">00:00:00</div>
                <div class="metric-change">
                    <div class="health-indicator">
                        <div class="health-dot" id="serverHealthDot"></div>
                        <span id="serverHealthText">Healthy</span>
                    </div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-icon">üë•</div>
                    <div class="metric-title">Active Connections</div>
                </div>
                <div class="metric-value" id="activeConnections">0</div>
                <div class="metric-change">
                    <span id="connectionChange">+0 from last hour</span>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-icon">üéÆ</div>
                    <div class="metric-title">Active Matches</div>
                </div>
                <div class="metric-value" id="activeMatches">0</div>
                <div class="metric-change">
                    <span id="matchesChange">0 in progress</span>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-icon">‚ö°</div>
                    <div class="metric-title">Tournament Progress</div>
                </div>
                <div class="metric-value" id="tournamentProgress">0%</div>
                <div class="metric-change">
                    <span id="progressStatus">Not Started</span>
                </div>
            </div>
        </div>
        <!-- Voice Commentary Section -->
<div class="control-panel">
    <div class="control-section">
        <h2 class="control-title">üéôÔ∏è Live Voice Commentary</h2>
        
        <div class="commentary-status" id="commentaryStatus">
            <div class="status-indicator" id="commentaryIndicator"></div>
            <span id="commentaryStatusText">Not Broadcasting</span>
        </div>
        
        <div class="commentary-controls">
            <button id="startCommentaryBtn" class="btn btn-primary cyber-btn">
                <span class="btn-text">START COMMENTARY</span>
            </button>
            <button id="stopCommentaryBtn" class="btn btn-secondary cyber-btn hidden">
                <span class="btn-text">STOP COMMENTARY</span>
            </button>
        </div>
        
        <div class="audio-visualizer" id="audioVisualizer">
            <canvas id="visualizerCanvas" width="400" height="100"></canvas>
        </div>
        
        <div class="commentary-info">
            <small>Players will hear your voice in real-time. Speak clearly into your microphone.</small>
        </div>
    </div>
</div>

        <!-- League Creation Section -->
        <div id="createSection" class="control-panel">
            <div class="control-section">
                <h2 class="control-title">üöÄ Create New Championship</h2>
                <div class="form-row">
                    <div class="input-group">
                        <label for="leagueName">Championship Name:</label>
                        <input type="text" id="leagueName" class="cyber-input" placeholder="Enter championship name..." maxlength="30">
                        <div class="input-underline"></div>
                    </div>
                    <div class="input-group">
                        <label for="maxPlayers">Max Players:</label>
                        <select id="maxPlayers" class="cyber-input">
                            <option value="2">2 Players</option>
                            <option value="4">4 Players</option>
    <option value="8" selected>8 Players</option>
    <option value="16">16 Players</option>
    <option value="20">20 Players</option>
    <option value="32">32 Players</option>
    <option value="48">48 Players</option>
</select>
                    </div>
                    <div class="input-group">
                        <label for="gameMode">Game Mode:</label>
                        <select id="gameMode" class="cyber-input">
                            <option value="classic">Classic League</option>
                            <option value="tournament" selected>Tournament Bracket</option>
                        </select>
                    </div>
                    <div class="input-group">
    <label for="matchDuration">Match Duration:</label>
    <select id="matchDuration" class="cyber-input">
        <option value="60">1 Minute</option>
        <option value="90">1 Min 30 Secs</option>
        <option value="120">2 Minutes</option>
        <option value="150">2 Mins 30 Secs</option>
        <option value="180" selected>3 Minutes</option>
        <option value="210">3 Mins 30 Secs</option>
        <option value="240">4 Minutes</option>
    </select>
</div>
                </div>
                <div class="btn-group">
 <button class="btn btn-primary cyber-btn" onclick="createLeague()">
                        <span class="btn-text">CREATE CHAMPIONSHIP</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- League Status Section -->
        <div id="statusSection" class="control-panel hidden">
            <div class="control-section">
                <h2 class="control-title">üìã Championship: <span id="currentLeagueName" class="highlight">-</span></h2>
                
                <div class="server-status">
                    <div class="status-item">
                        <span class="status-value" id="connectedPlayers">0</span>
                        <span class="status-label">Connected</span>
                    </div>
                    <div class="status-item">
                        <span class="status-value" id="totalSlots">0</span>
                        <span class="status-label">Total Slots</span>
                    </div>
                    <div class="status-item">
                        <span class="status-value" id="currentRound">0</span>
                        <span class="status-label">Current Round</span>
                    </div>
                    <div class="status-item">
                        <span class="status-value" id="totalRounds">0</span>
                        <span class="status-label">Total Rounds</span>
                    </div>
                    <div class="status-item">
                        <span class="status-value" id="eliminatedCount">0</span>
                        <span class="status-label">Eliminated</span>
                    </div>
                </div>
                
                <div id="leagueStatusMessage" class="status waiting">
                    <div class="orbit-spinner">
                        <div class="orbit orbit1"></div>
                        <div class="orbit orbit2"></div>
                        <div class="orbit orbit3"></div>
                    </div>
                    <p>Waiting for players to join...</p>
                </div>

                <div class="btn-group">
                    <button id="startLeagueBtn" class="btn btn-primary cyber-btn" onclick="startLeague()" disabled>
                        <span class="btn-text">START CHAMPIONSHIP</span>
                    </button>
                    <button class="btn btn-secondary cyber-btn" onclick="refreshStats()">
                        <span class="btn-text">REFRESH STATS</span>
                    </button>
                    <button class="btn cyber-btn" style="border-color: var(--accent-color); color: var(--accent-color);" onclick="resetLeague()">
                        <span class="btn-text">RESET CHAMPIONSHIP</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Tournament Bracket Visualization -->
        <div id="tournamentBracketSection" class="tournament-bracket-section hidden">
            <div class="control-section">
                <h2 class="control-title">üèÜ Tournament Bracket</h2>
                <div id="championDisplay" class="champion-display hidden">
                    <h2>üèÜ CHAMPION üèÜ</h2>
                    <div class="champion-name" id="championName">-</div>
                </div>
                <div id="tournamentBracket" class="bracket-container">
                    <!-- Tournament bracket will be populated here -->
                </div>
                <div class="tournament-stats-grid">
                    <div class="tournament-stat-card">
                        <span class="tournament-stat-value" id="byesAwarded">0</span>
                        <span class="tournament-stat-label">Byes Awarded</span>
                    </div>
                    <div class="tournament-stat-card">
                        <span class="tournament-stat-value" id="goldenGoalMatches">0</span>
                        <span class="tournament-stat-label">Golden Goal</span>
                    </div>
                    <div class="tournament-stat-card">
                        <span class="tournament-stat-value" id="tournamentDuration">00:00</span>
                        <span class="tournament-stat-label">Duration</span>
                    </div>
                    <div class="tournament-stat-card">
                        <span class="tournament-stat-value" id="averageMatchTime">0:00</span>
                        <span class="tournament-stat-label">Avg Match</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Player Management -->
        <div id="playersSection" class="control-panel hidden">
            <div class="control-section">
                <h2 class="control-title">üë• Player Management</h2>
                <div class="player-list" id="playerList">
                    <!-- Dynamic player list will appear here -->
                </div>
                <div id="eliminationList" class="elimination-list hidden">
                    <h3>Eliminated Players</h3>
                    <div id="eliminatedPlayers">
                        <!-- Eliminated players will appear here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Matches Section -->
        <div id="matchesSection" class="control-panel hidden">
            <div class="control-section">
                <h2 class="control-title">üéÆ Live Matches - <span id="liveMatchInfo">Round 1</span></h2>
                <div id="liveMatches" class="match-grid">
                    <!-- Live matches will be populated here -->
                </div>
            </div>
        </div>

        <!-- Enhanced League Table Section -->
        <div id="tableSection" class="control-panel hidden">
            <div class="control-section">
                <h2 class="control-title">üìä Championship Table</h2>
                <div class="table-wrapper">
                    <table class="enhanced-table" id="leagueTable">
                        <thead>
                            <tr>
                                <th>Pos</th>
                                <th>Player</th>
                                <th>P</th>
                                <th>W</th>
                                <th>D</th>
                                <th>L</th>
                                <th>GF</th>
                                <th>GA</th>
                                <th>GD</th>
                                <th>Pts</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="leagueTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Final Results Section -->
        <div id="resultsSection" class="control-panel hidden">
            <div class="control-section">
                <h2 class="control-title">üèÜ Championship Results</h2>
                
                <div id="finalAwards" class="awards-container">
                    <!-- Awards will be displayed here -->
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-number" id="participantCount">0</div>
                        <div class="stat-label">Participants</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-number" id="leagueDuration">00:00</div>
                        <div class="stat-label">Duration</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üéÆ</div>
                        <div class="stat-number" id="completedMatches">0</div>
                        <div class="stat-label">Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ö°</div>
                        <div class="stat-number" id="totalEvents">0</div>
                        <div class="stat-label">Events</div>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-secondary cyber-btn" onclick="exportResults()">
                        <span class="btn-text">EXPORT RESULTS</span>
                    </button>
                    <button class="btn btn-primary cyber-btn" onclick="location.reload()">
                        <span class="btn-text">NEW CHAMPIONSHIP</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Server Log Section -->
        <div id="logSection" class="control-panel">
            <div class="control-section">
                <h2 class="control-title">üìã Server Log</h2>
                <div class="log-container" id="serverLog">
                    <!-- Server logs will appear here -->
                </div>
                <div class="btn-group" style="margin-top: var(--spacing-md);">
                    <button class="btn btn-secondary cyber-btn" onclick="clearLog()">
                        <span class="btn-text">CLEAR LOG</span>
                    </button>
                    <button class="btn btn-secondary cyber-btn" onclick="refreshLog()">
                        <span class="btn-text">REFRESH</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- System Messages -->
        <div id="notifications" class="notification-container"></div>
    </div>

    <!-- Background Effects -->
    <div class="background-effects">
        <div class="grid-lines"></div>
        <div class="particles" id="particles"></div>
        <div class="scanlines"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Enhanced Tournament Admin Client
        class PongLeague2TournamentAdmin {
            constructor() {
                this.socket = null;
                this.adminState = {
                    leagueCreated: false,
                    leagueStarted: false,
                    leagueFinished: false,
                    currentLeague: null,
                    gameMode: 'classic',
                    players: new Map(),
                    leagueTable: [],
                    liveMatches: [],
                    serverStats: {},
                    // Tournament-specific
                    tournamentBracket: null,
                    currentRound: 0,
                    totalRounds: 0,
                    eliminatedPlayers: new Set(),
                    champion: null
                };
                
                this.serverMetrics = {
                    uptime: 0,
                    connections: 0,
                    matches: 0,
                    performance: 100
                };
                
                this.logEntries = [];
                this.maxLogEntries = 1000;
                
                this.init();
            }
            
            async init() {
                console.log('Initializing Tournament Admin...');
                this.initSocket();
                this.startMetricsUpdater();
                this.initBackgroundEffects();
                this.setupEventListeners();
            }
            
            setupEventListeners() {
                document.getElementById('leagueName')?.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') createLeague();
                });
                
                document.getElementById('gameMode')?.addEventListener('change', (e) => {
                    this.handleGameModeChange(e.target.value);
                });
                
                setInterval(() => {
                    if (this.adminState.leagueStarted && !this.adminState.leagueFinished) {
                        this.refreshStats();
                    }
                }, 30000);
            }
            
            handleGameModeChange(gameMode) {
                if (gameMode === 'tournament') {
                    document.querySelector('h1 .glitch').textContent = 'üèÜ TOURNAMENT ADMIN CENTER';
                    document.querySelector('.subtitle').textContent = 'Advanced Tournament Control & Bracket Management';
                } else {
                    document.querySelector('h1 .glitch').textContent = 'üéÆ PONG LEAGUE 2.0 ADMIN';
                    document.querySelector('.subtitle').textContent = 'Advanced Championship Control Center';
                }
            }
            
            initSocket() {
                this.socket = io({
                    transports: ['websocket', 'polling'],
                    timeout: 20000
                });
                
                this.setupSocketListeners();
                this.startNetworkMonitoring();
            }
            
            setupSocketListeners() {
                // Connection events
                this.socket.on('connect', () => this.handleConnect());
                this.socket.on('disconnect', (reason) => this.handleDisconnect(reason));
                this.socket.on('connect_error', (error) => this.handleConnectionError(error));
                
                // League management
                this.socket.on('league-created-enhanced', (data) => this.handleLeagueCreated(data));
                this.socket.on('player-joined-enhanced', (data) => this.handlePlayerJoined(data));
                this.socket.on('player-left-enhanced', (data) => this.handlePlayerLeft(data));
                this.socket.on('league-started-enhanced', (data) => this.handleLeagueStarted(data));
                
                // Tournament events
                this.socket.on('tournament-bracket-created', (data) => this.handleTournamentBracketCreated(data));
                this.socket.on('tournament-round-started', (data) => this.handleTournamentRoundStarted(data));
                this.socket.on('tournament-finished-enhanced', (data) => this.handleTournamentFinished(data));
                this.socket.on('tournament-bracket-updated', (data) => this.handleTournamentBracketUpdated(data));
this.socket.on('tournament-round-announcement', (data) => this.handleTournamentRoundAnnouncement(data));
                
                // Match events
                this.socket.on('matchday-started-enhanced', (data) => this.handleMatchdayStarted(data));
                this.socket.on('match-start-enhanced', (data) => this.handleMatchStart(data));
                this.socket.on('match-finished-enhanced', (data) => this.handleMatchFinished(data));
                this.socket.on('matchday-finished-enhanced', (data) => this.handleMatchdayFinished(data));
                // Add this in the setupSocketListeners method
this.socket.on('championship-reset', (data) => this.handleChampionshipReset(data));
                
                // Statistics
                this.socket.on('league-stats-enhanced', (data) => this.handleLeagueStats(data));
                this.socket.on('league-finished-enhanced', (data) => this.handleLeagueFinished(data));
                
                // Network monitoring
                this.socket.on('pong', (timestamp) => this.handlePong(timestamp));
                // Live match updates
this.socket.on('admin-match-update', (data) => this.handleAdminMatchUpdate(data));
                
                // Error handling
                this.socket.on('error', (error) => this.handleError(error));
            }
            
            startNetworkMonitoring() {
                setInterval(() => {
                    if (this.socket?.connected) {
                        this.lastPingTime = Date.now();
                        this.socket.emit('ping', this.lastPingTime);
                    }
                }, 5000);
            }
            
            startMetricsUpdater() {
                setInterval(() => {
                    this.updateServerMetrics();
                }, 1000);
            }
            
            // Socket Event Handlers
            handleConnect() {
                console.log('Tournament Admin connected to server');
                this.updateConnectionStatus('connected');
                this.addLogEntry('info', 'Connected to server');
                this.showNotification('Connected to server', 'success');
            }
            
            handleDisconnect(reason) {
                console.log('Tournament Admin disconnected:', reason);
                this.updateConnectionStatus('disconnected');
                this.addLogEntry('warn', `Disconnected: ${reason}`);
                this.showNotification('Disconnected from server', 'error');
            }
            
            handleConnectionError(error) {
                console.error('Connection error:', error);
                this.updateConnectionStatus('error');
                this.addLogEntry('error', `Connection error: ${error.message}`);
                this.showNotification('Connection failed', 'error');
            }
            
handleLeagueCreated(data) {
    this.adminState.leagueCreated = true;
    this.adminState.currentLeague = data.league;
    this.adminState.gameMode = data.league.gameMode;
    
    // Reset league state for new championship
    this.adminState.leagueStarted = false;
    this.adminState.leagueFinished = false;
    this.adminState.players.clear();
    this.adminState.eliminatedPlayers.clear();
    
    document.getElementById('currentLeagueName').textContent = data.league.name;
    document.getElementById('totalSlots').textContent = data.league.maxPlayers;
    document.getElementById('connectedPlayers').textContent = '0';
    
    // Reset status message to waiting
    document.getElementById('leagueStatusMessage').innerHTML = `
        <div class="status waiting">
            <div class="orbit-spinner">
                <div class="orbit orbit1"></div>
                <div class="orbit orbit2"></div>
                <div class="orbit orbit3"></div>
            </div>
            <p>Waiting for players to join...</p>
        </div>
    `;
    
    // CRITICAL FIX: Show and reset the start button
    const startBtn = document.getElementById('startLeagueBtn');
    if (startBtn) {
        startBtn.style.display = 'block';
        startBtn.disabled = true;
        startBtn.innerHTML = '<span class="btn-text">Need 2 more players</span>';
    }
    
    this.showSection('statusSection');
    this.showSection('playersSection');
    
    if (data.league.gameMode === 'tournament') {
        this.showSection('tournamentBracketSection');
        // Clear any previous bracket display
        document.getElementById('tournamentBracket').innerHTML = '';
        document.getElementById('championDisplay').classList.add('hidden');
    } else {
        this.showSection('tableSection');
    }
    
    // Hide results section if it was showing
    const resultsSection = document.getElementById('resultsSection');
    if (resultsSection) {
        resultsSection.classList.add('hidden');
    }
    
    this.addLogEntry('info', `${data.league.gameMode === 'tournament' ? 'Tournament' : 'League'} "${data.league.name}" created`);
    this.showNotification(`${data.league.gameMode === 'tournament' ? 'Tournament' : 'League'} created!`, 'success');
    this.updateStartButton();
}
            
            handlePlayerJoined(data) {
                document.getElementById('connectedPlayers').textContent = data.playersCount;
                this.addLogEntry('info', `${data.playerName} joined (${data.playersCount}/${this.adminState.currentLeague?.maxPlayers})`);
                this.showNotification(`${data.playerName} joined`, 'success');
                this.updateStartButton();
                this.updatePlayerList();
            }
            
            handlePlayerLeft(data) {
                document.getElementById('connectedPlayers').textContent = data.playersCount;
                this.addLogEntry('warn', `${data.playerName} left`);
                this.showNotification(`${data.playerName} left`, 'warning');
                this.updateStartButton();
                this.updatePlayerList();
            }
            
            handleLeagueStarted(data) {
                this.adminState.leagueStarted = true;
                this.adminState.gameMode = data.gameMode;
                
                document.getElementById('leagueStatusMessage').innerHTML = `
                    <div class="status active">${data.gameMode === 'tournament' ? 'Tournament' : 'League'} is running!</div>
                `;
                document.getElementById('startLeagueBtn').style.display = 'none';
                
                if (data.gameMode === 'tournament') {
                    document.getElementById('progressStatus').textContent = 'Tournament Started';
                } else {
                    document.getElementById('totalRounds').textContent = data.totalMatchdays || 0;
                }
                
                this.showSection('matchesSection');
                
                this.addLogEntry('info', `${data.gameMode === 'tournament' ? 'Tournament' : 'League'} started with ${data.playersCount} players`);
                this.showNotification(`${data.gameMode === 'tournament' ? 'Tournament' : 'League'} started!`, 'success');
            }
            handleTournamentBracketUpdated(data) {
    console.log('Admin: Bracket updated', data);
    this.adminState.tournamentBracket = data.bracket;
    this.displayTournamentBracket(data.bracket);
    
    if (data.matchCompleted) {
        this.addLogEntry('info', `Match completed: ${data.matchCompleted.winner} won`);
    }
}

handleTournamentRoundAnnouncement(data) {
    this.showNotification(data.message, 'success');
    this.addLogEntry('info', `${data.roundName} starting`);
    document.getElementById('liveMatchInfo').textContent = data.roundName;
}
            
            handleTournamentBracketCreated(data) {
                console.log('Tournament bracket created:', data);
                this.adminState.tournamentBracket = data.bracket;
                this.adminState.totalRounds = data.totalRounds;
                this.adminState.currentRound = data.currentRound;
                
                document.getElementById('totalRounds').textContent = data.totalRounds;
                document.getElementById('currentRound').textContent = data.currentRound;
                
                this.displayTournamentBracket(data.bracket);
                this.addLogEntry('info', `Tournament bracket created with ${data.totalRounds} rounds`);
            }
            
            handleTournamentRoundStarted(data) {
                console.log('Tournament round started:', data);
                this.adminState.currentRound = data.round;
                
                document.getElementById('currentRound').textContent = data.round;
                document.getElementById('liveMatchInfo').textContent = `Round ${data.round}`;
                
                const progress = (data.round / this.adminState.totalRounds) * 100;
                document.getElementById('tournamentProgress').textContent = `${Math.round(progress)}%`;
                
                this.displayLiveMatches(data.matches);
                this.addLogEntry('info', `Tournament round ${data.round} started`);
                this.showNotification(`Round ${data.round} started`, 'success');
            }
            
            handleTournamentFinished(data) {
                console.log('Tournament finished:', data);
                this.adminState.leagueFinished = true;
                this.adminState.champion = data.champion;
                
                document.getElementById('leagueStatusMessage').innerHTML = `
                    <div class="status finished">Tournament completed!</div>
                `;
                
                document.getElementById('progressStatus').textContent = 'Completed';
                document.getElementById('tournamentProgress').textContent = '100%';
                
                this.displayChampion(data.champion);
                this.displayTournamentResults(data);
                this.showSection('resultsSection');
                
                this.addLogEntry('info', `Tournament completed - Champion: ${data.champion}`);
                this.showNotification(`Tournament completed! Champion: ${data.champion}`, 'success');
                // Add this in the handleLeagueFinished or handleTournamentFinished methods
document.getElementById('createSection').classList.remove('hidden');
const createBtn = document.querySelector('#createSection .cyber-btn');
if (createBtn) {
    createBtn.innerHTML = '<span class="btn-text">CREATE NEW CHAMPIONSHIP</span>';
}
            }
            
            handleMatchdayStarted(data) {
                if (this.adminState.gameMode === 'tournament') return;
                
                document.getElementById('currentRound').textContent = data.matchday;
                document.getElementById('liveMatchInfo').textContent = `Matchday ${data.matchday}`;
                
                const progress = (data.matchday / data.totalMatchdays) * 100;
                document.getElementById('tournamentProgress').textContent = `${Math.round(progress)}%`;
                
                this.displayLiveMatches(data.matches);
                this.addLogEntry('info', `Matchday ${data.matchday} started`);
                this.showNotification(`Matchday ${data.matchday} started`, 'success');
            }
            
            handleMatchStart(data) {
                this.updateMatchStatus(data.matchId, 'active', 'In Progress');
                this.addLogEntry('info', `Match ${data.matchId} started`);
            }
            
            handleMatchFinished(data) {
                this.updateMatchStatus(data.matchId, 'finished', 'Completed');
                
                let logMessage = `Match completed: ${data.winner} won`;
                if (data.goldenGoal) {
                    logMessage += ' (Golden Goal)';
                }
                
                this.addLogEntry('info', logMessage);
                
                // Update tournament bracket if tournament mode
                if (this.adminState.gameMode === 'tournament' && this.adminState.tournamentBracket) {
                    this.updateBracketMatch(data.matchId, data.winner, data.finalScore);
                }
            }
            
            handleMatchdayFinished(data) {
                this.addLogEntry('info', `${this.adminState.gameMode === 'tournament' ? 'Round' : 'Matchday'} ${data.matchday || data.round} completed`);
                this.showNotification(`${this.adminState.gameMode === 'tournament' ? 'Round' : 'Matchday'} completed`, 'success');
                
                if (data.leagueTable) {
                    this.displayLeagueTable(data.leagueTable);
                }
            }
            
            handleLeagueStats(data) {
                this.adminState.serverStats = data.serverInfo;
                this.adminState.leagueTable = data.leagueTable;
                
                this.displayLeagueTable(data.leagueTable);
                this.updateAnalytics(data.globalStats, data.serverInfo);
                this.updatePlayerList(data.playerDetails);
                
                // Update tournament-specific data
                if (data.bracket) {
                    this.adminState.tournamentBracket = data.bracket;
                    this.displayTournamentBracket(data.bracket);
                    this.updateEliminatedPlayers(data.serverInfo.eliminatedPlayers);
                }
            }
            
            handleLeagueFinished(data) {
                this.adminState.leagueFinished = true;
                
                document.getElementById('leagueStatusMessage').innerHTML = `
                    <div class="status finished">Championship completed!</div>
                `;
                
                this.displayFinalResults(data);
                this.showSection('resultsSection');
                
                this.addLogEntry('info', 'Championship completed successfully');
                this.showNotification('Championship completed!', 'success');
                // Add this in the handleLeagueFinished or handleTournamentFinished methods
document.getElementById('createSection').classList.remove('hidden');
const createBtn = document.querySelector('#createSection .cyber-btn');
if (createBtn) {
    createBtn.innerHTML = '<span class="btn-text">CREATE NEW CHAMPIONSHIP</span>';
}
            }

            handleChampionshipReset(data) {
    console.log('Championship reset:', data);
    this.showNotification(data.message, 'info');
    
    // Optionally reload the admin panel after a delay
    setTimeout(() => {
        if (confirm('Championship completed. Reload admin panel for new championship?')) {
            location.reload();
        }
    }, 3000);
}
            
            handlePong(timestamp) {
                const latency = Date.now() - timestamp;
                this.updateLatencyDisplay(latency);
            }

            handleAdminMatchUpdate(data) {
    const matchCard = document.getElementById(`match-${data.matchId}`);
    if (!matchCard) return;
    
    // Update score
    const scoreEl = matchCard.querySelector(`#score-${data.matchId}`);
    if (scoreEl) {
        const score1 = data.score[data.player1] || 0;
        const score2 = data.score[data.player2] || 0;
        scoreEl.textContent = `${score1} - ${score2}`;
        scoreEl.style.color = score1 === score2 ? '#ffffff' : 
                             score1 > score2 ? '#00ff88' : '#ff4444';
    }
    
    // Update timer
    const timerEl = matchCard.querySelector(`#timer-${data.matchId}`);
    if (timerEl) {
        const mins = Math.floor(data.timeLeft / 60);
        const secs = data.timeLeft % 60;
        timerEl.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
        
        // Change color based on time remaining
        if (data.goldenGoalMode) {
            timerEl.style.color = '#ffaa00';
            timerEl.textContent = 'Golden Goal';
        } else if (data.timeLeft <= 30) {
            timerEl.style.color = '#ff4444';
        } else if (data.timeLeft <= 60) {
            timerEl.style.color = '#ffaa00';
        } else {
            timerEl.style.color = '#00ff88';
        }
    }
    
    // Update match status
    if (!data.gameActive) {
        this.updateMatchStatus(data.matchId, 'finished', 'Completed');
    }
}
            
            handleError(error) {
                console.error('Server error:', error);
                this.addLogEntry('error', error.message || JSON.stringify(error));
                this.showNotification(error.message || 'Server error', 'error');
            }
            
            // Tournament-specific UI methods
            displayTournamentBracket(bracketData) {
                const bracketContainer = document.getElementById('tournamentBracket');
                if (!bracketContainer) return;
                
                bracketContainer.innerHTML = this.generateBracketHTML(bracketData);
                
                // Update tournament stats
                if (bracketData.byeHistory) {
                    document.getElementById('byesAwarded').textContent = bracketData.byeHistory.reduce((total, [player, byes]) => total + byes, 0);
                }
                
                console.log('Tournament bracket displayed');
            }
            
generateBracketHTML(bracketData) {
    let html = '';
    
    for (let round = 1; round <= bracketData.totalRounds; round++) {
        const roundMatches = bracketData.rounds[round] || [];
        const actualMatches = roundMatches.filter(m => !m.isBye);
        const roundsRemaining = bracketData.totalRounds - round + 1;
        
        // Determine round name
        let roundName = `Round ${round}`;
        if (roundsRemaining === 1 || actualMatches.length === 1) {
            roundName = 'FINAL';
        } else if (roundsRemaining === 2 || actualMatches.length === 2) {
            roundName = 'SEMI-FINALS';
        } else if (roundsRemaining === 3 || actualMatches.length === 4) {
            roundName = 'QUARTER-FINALS';
        } else if (roundsRemaining === 4 || actualMatches.length === 8) {
            roundName = 'ROUND OF 16';
        }
        
        html += `<div class="bracket-round" data-round="${round}">`;
        html += `<div class="round-header">${roundName}</div>`;
        
        roundMatches.forEach(match => {
            const status = match.completed ? 'completed' : match.isBye ? 'bye' : match.status === 'active' ? 'active' : 'pending';
            
            html += `<div class="bracket-match ${status}" data-match-id="${match.id}">`;
            
            if (match.isBye) {
                html += `<div class="match-player winner">${match.player1}</div>`;
                html += `<div class="bye-indicator">BYE</div>`;
            } else {
                // Check if players are eliminated
                const player1Eliminated = this.adminState.eliminatedPlayers.has(match.player1);
                const player2Eliminated = this.adminState.eliminatedPlayers.has(match.player2);
                const player1Classes = `match-player ${match.winner === match.player1 ? 'winner' : ''} ${player1Eliminated ? 'eliminated' : ''}`;
                const player2Classes = `match-player ${match.winner === match.player2 ? 'winner' : ''} ${player2Eliminated ? 'eliminated' : ''}`;
                
                html += `<div class="${player1Classes}">${match.player1}</div>`;
                html += `<div class="match-vs">vs</div>`;
                html += `<div class="${player2Classes}">${match.player2}</div>`;
            }
            
            if (match.completed && match.score) {
                html += `<div class="match-score">${match.score[match.player1] || 0} - ${match.score[match.player2] || 0}</div>`;
            }
            
            if (match.goldenGoal) {
                html += '<div class="golden-goal-indicator">GOLDEN GOAL</div>';
            }
            
            html += '</div>';
        });
        
        html += '</div>';
    }
    
    return html;
}
            
            displayChampion(champion) {
                const championDisplay = document.getElementById('championDisplay');
                const championName = document.getElementById('championName');
                
                if (championDisplay && championName) {
                    championDisplay.classList.remove('hidden');
                    championName.textContent = champion;
                }
            }
            
            updateBracketMatch(matchId, winner, score) {
                // Update the specific match in the bracket display
                const matchElement = document.querySelector(`[data-match-id="${matchId}"]`);
                if (matchElement) {
                    matchElement.classList.remove('active', 'pending');
                    matchElement.classList.add('completed');
                    
                    // Update winner highlighting
                    const players = matchElement.querySelectorAll('.match-player');
                    players.forEach(playerEl => {
                        if (playerEl.textContent === winner) {
                            playerEl.classList.add('winner');
                        }
                    });
                    
                    // Add score if available
                    if (score) {
                        const existingScore = matchElement.querySelector('.match-score');
                        if (existingScore) {
                            existingScore.remove();
                        }
                        
                        const scoreEl = document.createElement('div');
                        scoreEl.className = 'match-score';
                        const player1 = Object.keys(score)[0];
                        const player2 = Object.keys(score)[1];
                        scoreEl.textContent = `${score[player1]} - ${score[player2]}`;
                        matchElement.appendChild(scoreEl);
                    }
                }
            }
            
updateEliminatedPlayers(eliminatedPlayers = []) {
    // Update the Set with eliminated players
    this.adminState.eliminatedPlayers = new Set(eliminatedPlayers);
    
    const eliminationList = document.getElementById('eliminationList');
    const eliminatedPlayersContainer = document.getElementById('eliminatedPlayers');
    
    if (eliminatedPlayers.length > 0) {
        eliminationList.classList.remove('hidden');
        eliminatedPlayersContainer.innerHTML = '';
        
        eliminatedPlayers.forEach(player => {
            const eliminationItem = document.createElement('div');
            eliminationItem.className = 'elimination-item';
            eliminationItem.innerHTML = `
                <span>${player}</span>
                <span class="elimination-round">Eliminated</span>
            `;
            eliminatedPlayersContainer.appendChild(eliminationItem);
        });
        
        document.getElementById('eliminatedCount').textContent = eliminatedPlayers.length;
        
        // Refresh bracket display to show eliminated styling
        if (this.adminState.tournamentBracket) {
            this.displayTournamentBracket(this.adminState.tournamentBracket);
        }
    } else {
        eliminationList.classList.add('hidden');
    }
}
            
            // UI Update Methods (continuing existing methods with tournament enhancements)
            updateConnectionStatus(status) {
                const indicator = document.getElementById('statusIndicator');
                const text = document.getElementById('statusText');
                
                if (indicator) indicator.className = `status-indicator ${status}`;
                if (text) {
                    const statusTexts = {
                        'connected': 'Connected',
                        'disconnected': 'Disconnected',
                        'error': 'Error'
                    };
                    text.textContent = statusTexts[status] || 'Unknown';
                }
            }
            
            updateLatencyDisplay(latency) {
                const latencyEl = document.getElementById('latencyDisplay');
                if (latencyEl) latencyEl.textContent = `${latency}ms`;
            }
            
            updateServerMetrics() {
                this.serverMetrics.uptime += 1;
                const uptimeEl = document.getElementById('serverUptime');
                if (uptimeEl) {
                    const hours = Math.floor(this.serverMetrics.uptime / 3600);
                    const minutes = Math.floor((this.serverMetrics.uptime % 3600) / 60);
                    const seconds = this.serverMetrics.uptime % 60;
                    uptimeEl.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
                
                if (this.adminState.serverStats) {
                    const stats = this.adminState.serverStats;
                    document.getElementById('activeConnections').textContent = stats.activeConnections || 0;
                    document.getElementById('activeMatches').textContent = stats.activeGames || 0;
                    
                    const health = this.calculateServerHealth(stats);
                    this.updateServerHealth(health);
                }
            }
            
            calculateServerHealth(stats) {
                let health = 'healthy';
                let score = 100;
                
                if (stats.activeConnections > 50) score -= 20;
                else if (stats.activeConnections > 30) score -= 10;
                
                if (stats.activeGames > 10) score -= 30;
                else if (stats.activeGames > 5) score -= 15;
                
                if (score < 60) health = 'critical';
                else if (score < 80) health = 'warning';
                
                return { status: health, score };
            }
            
            updateServerHealth(health) {
                const healthDot = document.getElementById('serverHealthDot');
                const healthText = document.getElementById('serverHealthText');
                
                if (healthDot) {
                    healthDot.className = `health-dot ${health.status === 'healthy' ? '' : health.status}`;
                }
                
                if (healthText) {
                    const statusTexts = {
                        'healthy': 'Healthy',
                        'warning': 'Warning',
                        'critical': 'Critical'
                    };
                    healthText.textContent = statusTexts[health.status];
                }
            }
            
updateStartButton() {
    const connectedPlayers = parseInt(document.getElementById('connectedPlayers')?.textContent || '0');
    const startBtn = document.getElementById('startLeagueBtn');
    
    if (!startBtn) return;
    
    if (connectedPlayers >= 2 && !this.adminState.leagueStarted) {
        startBtn.disabled = false;
        startBtn.innerHTML = `<span class="btn-text">START ${this.adminState.gameMode === 'tournament' ? 'TOURNAMENT' : 'LEAGUE'} (${connectedPlayers} players)</span>`;
    } else if (connectedPlayers < 2) {
        startBtn.disabled = true;
        startBtn.innerHTML = `<span class="btn-text">Need ${2 - connectedPlayers} more player${connectedPlayers === 1 ? '' : 's'}</span>`;
    }
}
            
            updatePlayerList(playerDetails = []) {
                const playerList = document.getElementById('playerList');
                if (!playerList) return;
                
                playerList.innerHTML = '';
                
                if (playerDetails.length === 0) {
                    playerList.innerHTML = '<div class="player-item"><div class="player-info">No players connected</div></div>';
                    return;
                }
                
                playerDetails.forEach(player => {
                    const playerItem = document.createElement('div');
                    playerItem.className = 'player-item';
                    
                    const initials = player.name.substring(0, 2).toUpperCase();
                    const status = player.disconnected ? 'offline' : player.eliminated ? 'away' : 'online';
                    const latency = player.averageLatency || 0;
                    
                    playerItem.innerHTML = `
                        <div class="player-info">
                            <div class="player-avatar">${initials}</div>
                            <div>
                                <div class="player-name">${player.name}${player.eliminated ? ' (Eliminated)' : ''}</div>
                                <small>${player.wins}W ${player.draws}D ${player.losses}L - ${player.points}pts</small>
                            </div>
                        </div>
                        <div class="player-status">
                            <small>${latency}ms</small>
                            <div class="status-dot ${status}"></div>
                        </div>
                    `;
                    
                    playerList.appendChild(playerItem);
                });
            }
            
displayLiveMatches(matches) {
    const container = document.getElementById('liveMatches');
    if (!container) return;
    
    container.innerHTML = '';
    
    matches.forEach(match => {
        const matchCard = document.createElement('div');
        matchCard.className = 'match-card';
        matchCard.id = `match-${match.id}`;
        
        let matchTitle = this.adminState.gameMode === 'tournament' ? 
            `Tournament Match` : `Match ${match.id}`;
        
        matchCard.innerHTML = `
            <div class="match-header">
                <div class="match-id">${matchTitle}</div>
                <div class="match-status-badge waiting">Waiting</div>
            </div>
            <div class="match-players">
                <strong style="color: #00ff88;">${match.player1}</strong> 
                <span style="color: #666;">vs</span> 
                <strong style="color: #0099ff;">${match.player2}</strong>
            </div>
            <div class="match-score" id="score-${match.id}" style="font-size: 1.5rem; font-weight: bold;">0 - 0</div>
            <div class="match-timer" id="timer-${match.id}" style="font-size: 1.2rem; color: #00ff88;">3:00</div>
        `;
        
        container.appendChild(matchCard);
    });
}
            
            updateMatchStatus(matchId, status, statusText) {
                const matchCard = document.getElementById(`match-${matchId}`);
                if (!matchCard) return;
                
                const statusBadge = matchCard.querySelector('.match-status-badge');
                if (statusBadge) {
                    statusBadge.className = `match-status-badge ${status}`;
                    statusBadge.textContent = statusText;
                }
                
                matchCard.className = `match-card ${status}`;
            }
            
            displayLeagueTable(leagueTable) {
                const tbody = document.getElementById('leagueTableBody');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                
                leagueTable.forEach((player, index) => {
                    const row = document.createElement('tr');
                    
                    if (index === 0) row.style.background = 'linear-gradient(90deg, rgba(255, 215, 0, 0.1), transparent)';
                    else if (index === 1) row.style.background = 'linear-gradient(90deg, rgba(192, 192, 192, 0.1), transparent)';
                    else if (index === 2) row.style.background = 'linear-gradient(90deg, rgba(205, 127, 50, 0.1), transparent)';
                    
                    const statusIndicator = player.disconnected ? 
                        '<div class="status-dot offline"></div>' : 
                        player.eliminated ? '<div class="status-dot away"></div>' :
                        '<div class="status-dot"></div>';
                    
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${player.name}</td>
                        <td>${player.matches}</td>
                        <td>${player.wins}</td>
                        <td>${player.draws}</td>
                        <td>${player.losses}</td>
                        <td>${player.goalsFor}</td>
                        <td>${player.goalsAgainst}</td>
                        <td>${player.goalDifference > 0 ? '+' : ''}${player.goalDifference}</td>
                        <td>${player.points}</td>
                        <td>${statusIndicator}</td>
                    `;
                    
                    tbody.appendChild(row);
                });
            }
            
            updateAnalytics(globalStats, serverInfo) {
                // Update tournament-specific stats if available
                if (globalStats?.byesAwarded !== undefined) {
                    document.getElementById('byesAwarded').textContent = globalStats.byesAwarded;
                }
                if (globalStats?.goldenGoalMatches !== undefined) {
                    document.getElementById('goldenGoalMatches').textContent = globalStats.goldenGoalMatches;
                }
            }
            
            displayTournamentResults(data) {
                const container = document.getElementById('finalAwards');
                if (!container) return;
                
                container.innerHTML = '';
                
                // Champion award
                const championAward = document.createElement('div');
                championAward.className = 'award-item champion';
                championAward.innerHTML = `
                    <div class="award-icon">üèÜ</div>
                    <h3>Tournament Champion</h3>
                    <div class="award-winner">${data.champion}</div>
                    <div class="award-stats">Eliminated all opponents</div>
                `;
                container.appendChild(championAward);
                
                // Update summary statistics
                const summary = data.tournamentSummary || {};
                document.getElementById('participantCount').textContent = summary.participantCount || 0;
                document.getElementById('leagueDuration').textContent = this.formatDuration(summary.duration / 1000 || 0);
                document.getElementById('completedMatches').textContent = summary.totalMatches || 0;
                document.getElementById('totalEvents').textContent = summary.totalRounds || 0;
                
                // Update tournament-specific stats
                document.getElementById('tournamentDuration').textContent = this.formatDuration(summary.duration / 1000 || 0);
                document.getElementById('byesAwarded').textContent = summary.byesAwarded || 0;
                document.getElementById('goldenGoalMatches').textContent = summary.goldenGoalMatches || 0;
                
                if (summary.averageMatchDuration) {
                    document.getElementById('averageMatchTime').textContent = this.formatDuration(summary.averageMatchDuration);
                }
            }
            
            displayFinalResults(data) {
                // Handle both tournament and league results
                if (this.adminState.gameMode === 'tournament') {
                    this.displayTournamentResults(data);
                } else {
                    this.displayRegularLeagueResults(data);
                }
            }
            
            displayRegularLeagueResults(data) {
                const container = document.getElementById('finalAwards');
                if (!container) return;
                
                const awards = data.awards;
                container.innerHTML = this.createRegularAwards(awards);
                
                const summary = data.leagueSummary || {};
                document.getElementById('participantCount').textContent = summary.participantCount || 0;
                document.getElementById('leagueDuration').textContent = this.formatDuration(summary.duration / 1000 || 0);
                document.getElementById('completedMatches').textContent = summary.totalMatches || 0;
                document.getElementById('totalEvents').textContent = summary.totalGoals || 0;
            }

            refreshStats() {
    if (!this.socket?.connected) {
        this.showNotification('Not connected to server', 'error');
        return;
    }
    
    this.socket.emit('get-league-stats');
    this.addLogEntry('info', 'Statistics refreshed');
}
            
            createRegularAwards(awards) {
                return `
                    <div class="award-item champion">
                        <div class="award-icon">üëë</div>
                        <h3>League Champion</h3>
                        <div class="award-winner">${awards.winner?.name || '-'}</div>
                        <div class="award-stats">${awards.winner?.points || 0} points</div>
                    </div>
                    <div class="award-item top-scorer">
                        <div class="award-icon">‚öΩ</div>
                        <h3>Top Scorer</h3>
                        <div class="award-winner">${awards.topScorer?.name || '-'}</div>
                        <div class="award-stats">${awards.topScorer?.goalsFor || 0} goals</div>
                    </div>
                    <div class="award-item best-player">
                        <div class="award-icon">‚≠ê</div>
                        <h3>Best Player</h3>
                        <div class="award-winner">${awards.bestPlayer?.name || '-'}</div>
                        <div class="award-stats">Overall Excellence</div>
                    </div>
                    <div class="award-item best-defense">
                        <div class="award-icon">üõ°</div>
                        <h3>Best Defense</h3>
                        <div class="award-winner">${awards.bestGoalDifference?.name || '-'}</div>
                        <div class="award-stats">${awards.bestGoalDifference?.goalDifference > 0 ? '+' : ''}${awards.bestGoalDifference?.goalDifference || 0} GD</div>
                    </div>
                `;
            }
            
            showSection(sectionId) {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('hidden');
                }
            }
            
            addLogEntry(level, message) {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = { timestamp, level, message };
                
                this.logEntries.unshift(logEntry);
                
                if (this.logEntries.length > this.maxLogEntries) {
                    this.logEntries = this.logEntries.slice(0, this.maxLogEntries);
                }
                
                this.updateLogDisplay();
            }
            
            updateLogDisplay() {
                const logContainer = document.getElementById('serverLog');
                if (!logContainer) return;
                
                const logHtml = this.logEntries.slice(0, 50).map(entry => `
                    <div class="log-entry">
                        <div class="log-timestamp">${entry.timestamp}</div>
                        <div class="log-level ${entry.level}">${entry.level.toUpperCase()}</div>
                        <div class="log-message">${entry.message}</div>
                    </div>
                `).join('');
                
                logContainer.innerHTML = logHtml;
                logContainer.scrollTop = 0;
            }
            
            showNotification(message, type = 'info', duration = 5000) {
                const container = document.getElementById('notifications');
                if (!container) {
                    console.log(`Admin Notification (${type}): ${message}`);
                    return;
                }
                
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                        <span>${this.getNotificationIcon(type)}</span>
                        <span>${message}</span>
                    </div>
                `;
                
                container.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, duration);
                
                const notifications = container.querySelectorAll('.notification');
                if (notifications.length > 5) {
                    notifications[0].remove();
                }
            }
            
            getNotificationIcon(type) {
                const icons = {
                    'success': '‚úÖ',
                    'error': '‚ùå',
                    'warning': '‚ö†Ô∏è',
                    'info': '‚ÑπÔ∏è'
                };
                return icons[type] || '‚ÑπÔ∏è';
            }
            
            formatDuration(seconds) {
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const secs = Math.floor(seconds % 60);
                
                if (hours > 0) {
                    return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                }
                return `${minutes}:${secs.toString().padStart(2, '0')}`;
            }
            
            initBackgroundEffects() {
                const particlesContainer = document.getElementById('particles');
                if (!particlesContainer) return;
                
                const createParticle = () => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + 'vw';
                    particle.style.animationDelay = Math.random() * 10 + 's';
                    particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                    
                    particlesContainer.appendChild(particle);
                    
                    setTimeout(() => {
                        if (particle.parentNode) particle.remove();
                    }, 25000);
                };
                
                for (let i = 0; i < 5; i++) {
                    setTimeout(createParticle, i * 2000);
                }
                
                setInterval(createParticle, 5000);
            }
        }
        
        // Global functions
        let adminClient = null;
        
function createLeague() {
    if (!adminClient?.socket?.connected) {
        adminClient?.showNotification('Not connected to server', 'error');
        return;
    }
    
    const leagueName = document.getElementById('leagueName').value.trim();
    const maxPlayers = document.getElementById('maxPlayers').value;
    const gameMode = document.getElementById('gameMode').value;
    const matchDuration = document.getElementById('matchDuration').value;
    
    if (!leagueName) {
        adminClient?.showNotification('Please enter a championship name', 'error');
        return;
    }
    
    if (leagueName.length > 30) {
        adminClient?.showNotification('Championship name must be 30 characters or less', 'error');
        return;
    }
    
    adminClient.socket.emit('create-league', {
        name: leagueName,
        maxPlayers: parseInt(maxPlayers),
        gameMode: gameMode,
        matchDuration: parseInt(matchDuration)
    });
}
        
        function startLeague() {
            if (!adminClient?.socket?.connected) {
                adminClient?.showNotification('Not connected to server', 'error');
                return;
            }
            
            adminClient.socket.emit('start-league');
        }
        
        function resetLeague() {
            if (confirm('Are you sure you want to reset the championship? This will disconnect all players and cannot be undone.')) {
                adminClient?.addLogEntry('warn', 'Championship reset by admin');
                location.reload();
            }
        }
        
function refreshStats() {
    if (!adminClient) {
        console.error('Admin client not initialized');
        return;
    }
    
    adminClient.refreshStats();
}
        
        function exportResults() {
            const data = {
                league: adminClient?.adminState.currentLeague,
                gameMode: adminClient?.adminState.gameMode,
                leagueTable: adminClient?.adminState.leagueTable,
                tournamentBracket: adminClient?.adminState.tournamentBracket,
                champion: adminClient?.adminState.champion,
                timestamp: new Date().toISOString(),
                version: '2.0'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pong-championship-results-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            adminClient?.addLogEntry('info', 'Results exported');
            adminClient?.showNotification('Results exported successfully', 'success');
        }
        
        function clearLog() {
            if (adminClient) {
                adminClient.logEntries = [];
                adminClient.updateLogDisplay();
                adminClient.showNotification('Log cleared', 'success');
            }
        }
        
        function refreshLog() {
            if (adminClient) {
                adminClient.updateLogDisplay();
                adminClient.showNotification('Log refreshed', 'success');
            }
        }

        
        
        // Initialize admin client
        document.addEventListener('DOMContentLoaded', () => {
            adminClient = new PongLeague2TournamentAdmin();
            console.log('Tournament Admin initialized');
        });
        
        window.addEventListener('beforeunload', () => {
            if (adminClient) {
                adminClient.addLogEntry('info', 'Admin panel closing');
            }
        });

        // Voice Commentary System
class VoiceCommentary {
    constructor() {
        this.isActive = false;
        this.mediaStream = null;
        this.audioContext = null;
        this.analyser = null;
        this.processor = null;
        this.visualizerCanvas = null;
        this.visualizerCtx = null;
        this.animationId = null;
    }
    
    async start() {
        try {
            // Request microphone access
            this.mediaStream = await navigator.mediaDevices.getUserMedia({
                audio: {
                    echoCancellation: true,
                    noiseSuppression: true,
                    autoGainControl: true,
                    sampleRate: 16000 // Lower sample rate for better streaming
                }
            });
            
            // Create audio context
            this.audioContext = new (window.AudioContext || window.webkitAudioContext)({
                sampleRate: 16000
            });
            
            // Create analyser for visualization
            this.analyser = this.audioContext.createAnalyser();
            this.analyser.fftSize = 2048;
            
            // Create media stream source
            const source = this.audioContext.createMediaStreamSource(this.mediaStream);
            source.connect(this.analyser);
            
            // Create script processor for audio chunks
            const bufferSize = 4096;
            this.processor = this.audioContext.createScriptProcessor(bufferSize, 1, 1);
            
            this.processor.onaudioprocess = (e) => {
                if (!this.isActive) return;
                
                const inputData = e.inputBuffer.getChannelData(0);
                
                // Convert Float32Array to Int16Array for efficient transmission
                const int16Data = new Int16Array(inputData.length);
                for (let i = 0; i < inputData.length; i++) {
                    const s = Math.max(-1, Math.min(1, inputData[i]));
                    int16Data[i] = s < 0 ? s * 0x8000 : s * 0x7FFF;
                }
                
                // Send to server
                if (adminClient && adminClient.socket) {
                    adminClient.socket.emit('commentary-chunk', Array.from(int16Data));
                }
            };
            
            source.connect(this.processor);
            this.processor.connect(this.audioContext.destination);
            
            // Setup visualizer
            this.visualizerCanvas = document.getElementById('visualizerCanvas');
            this.visualizerCtx = this.visualizerCanvas.getContext('2d');
            
            this.isActive = true;
            
            // Notify server
            if (adminClient && adminClient.socket) {
                adminClient.socket.emit('start-commentary');
            }
            
            this.updateUI(true);
            this.visualize();
            
            adminClient.showNotification('Voice commentary started', 'success');
            console.log('Voice commentary started successfully');
            
        } catch (error) {
            console.error('Failed to start commentary:', error);
            adminClient.showNotification('Failed to access microphone: ' + error.message, 'error');
            this.stop();
        }
    }
    
    stop() {
        this.isActive = false;
        
        if (this.processor) {
            this.processor.disconnect();
            this.processor = null;
        }
        
        if (this.analyser) {
            this.analyser.disconnect();
            this.analyser = null;
        }
        
        if (this.audioContext) {
            this.audioContext.close();
            this.audioContext = null;
        }
        
        if (this.mediaStream) {
            this.mediaStream.getTracks().forEach(track => track.stop());
            this.mediaStream = null;
        }
        
        if (this.animationId) {
            cancelAnimationFrame(this.animationId);
            this.animationId = null;
        }
        
        // Notify server
        if (adminClient && adminClient.socket) {
            adminClient.socket.emit('stop-commentary');
        }
        
        this.updateUI(false);
        
        adminClient.showNotification('Voice commentary stopped', 'info');
        console.log('Voice commentary stopped');
    }
    
    visualize() {
        if (!this.isActive || !this.analyser) return;
        
        const bufferLength = this.analyser.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);
        
        const draw = () => {
            if (!this.isActive) return;
            
            this.animationId = requestAnimationFrame(draw);
            
            this.analyser.getByteTimeDomainData(dataArray);
            
            const canvas = this.visualizerCanvas;
            const ctx = this.visualizerCtx;
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.lineWidth = 2;
            ctx.strokeStyle = '#00ff88';
            ctx.beginPath();
            
            const sliceWidth = canvas.width / bufferLength;
            let x = 0;
            
            for (let i = 0; i < bufferLength; i++) {
                const v = dataArray[i] / 128.0;
                const y = v * canvas.height / 2;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                
                x += sliceWidth;
            }
            
            ctx.lineTo(canvas.width, canvas.height / 2);
            ctx.stroke();
        };
        
        draw();
    }
    
    updateUI(isActive) {
        const startBtn = document.getElementById('startCommentaryBtn');
        const stopBtn = document.getElementById('stopCommentaryBtn');
        const indicator = document.getElementById('commentaryIndicator');
        const statusText = document.getElementById('commentaryStatusText');
        
        if (isActive) {
            startBtn.classList.add('hidden');
            stopBtn.classList.remove('hidden');
            indicator.classList.add('connected');
            statusText.textContent = 'Broadcasting Live';
        } else {
            startBtn.classList.remove('hidden');
            stopBtn.classList.add('hidden');
            indicator.classList.remove('connected');
            statusText.textContent = 'Not Broadcasting';
        }
    }
}

// Initialize commentary system
let voiceCommentary = null;

document.addEventListener('DOMContentLoaded', () => {
    voiceCommentary = new VoiceCommentary();
    
    const startBtn = document.getElementById('startCommentaryBtn');
    const stopBtn = document.getElementById('stopCommentaryBtn');
    
    if (startBtn) {
        startBtn.addEventListener('click', () => {
            voiceCommentary.start();
        });
    }
    
    if (stopBtn) {
        stopBtn.addEventListener('click', () => {
            voiceCommentary.stop();
        });
    }
});
    </script>
</body>
</html>